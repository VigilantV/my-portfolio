import { useState, useRef, useEffect } from "react";
import VerticalTitles from "./VerticalTitles";
import ProjectsImages from "./ProjectsImages";
import { TitleSvg } from "../../common";
import classes from "../../../styles/desktop/projects.module.scss";

const Projects = ({ currentSectionIndex, navigateToSection }) => {
  const [clickedBtnIndex, setClickedBtnIndex] = useState(-1);
  const [titleAnimated, setTitleAnimated] = useState(false);

  const [primaryImage, setPrimaryImage] = useState(null);
  const [secondaryImage, setSecondaryImage] = useState(null);
  const [websiteUrl, setWebsiteUrl] = useState("");
  const [githubUrl, setGithubUrl] = useState("");
  const [isDuringAnimation, setIsDuringAnimation] = useState(false);

  const projectsAnimationRef = useRef(null);

  useEffect(() => {
    if (currentSectionIndex === 1 && !titleAnimated) {
      setTimeout(() => {
        setTitleAnimated(true);
      }, 500);
    }
  }, [currentSectionIndex, titleAnimated]);

  return (
    <div
      id="projects_section"
      ref={projectsAnimationRef}
      className={classes.projects_section}
    >
      <div className={classes.title}>
        <TitleSvg
          pathData="M2.35 45.30Q1.25 45.30 0.62 44.65Q0 44 0 43.20Q0 42.40 0.20 41.55L6.40 13.20Q6.60 12.30 7.25 11.77Q7.90 11.25 8.85 11.25Q10.60 11.25 11.15 12.95L18.20 35.10L26.20 12.85Q26.80 11.25 28.70 11.25Q29.55 11.25 30.13 11.77Q30.70 12.30 30.90 13.20L37.25 41.50Q37.50 42.65 37.50 43Q37.50 43.95 36.80 44.63Q36.10 45.30 35.05 45.30Q34.05 45.30 33.45 44.77Q32.85 44.25 32.65 43.40L28.05 22.50L20.35 43.70Q20.10 44.45 19.45 44.88Q18.80 45.30 18.00 45.30Q16.25 45.30 15.70 43.60L9.20 23.25L4.80 43.35Q4.60 44.25 3.95 44.77Q3.30 45.30 2.35 45.30ZM45.85 54.25Q44.95 54.25 44.30 53.52Q43.65 52.80 43.65 51.80Q43.65 51.35 43.90 50.75L48.25 41.40L39.30 23.95Q39.00 23.35 39.00 22.75Q39.00 21.75 39.73 21.02Q40.45 20.30 41.50 20.30Q42.30 20.30 42.90 20.75Q43.50 21.20 43.80 21.80L50.85 35.75L57.15 21.80Q57.45 21.15 58.08 20.70Q58.70 20.25 59.45 20.25Q60.35 20.25 61.00 20.95Q61.65 21.65 61.65 22.70Q61.65 23.30 61.45 23.70L48.10 52.70Q47.80 53.40 47.20 53.83Q46.60 54.25 45.85 54.25ZM85.85 45.30Q84.85 45.30 84.10 44.60Q83.35 43.90 83.35 42.85L83.35 14.30Q83.35 12.90 83.70 12.27Q84.05 11.65 85.03 11.42Q86.00 11.20 88.20 11.20Q97.50 11.20 102.13 13.95Q106.75 16.70 106.75 21.90Q106.75 26.10 103.80 28.80Q100.85 31.50 96.65 32.75Q92.45 34 88.30 34.15L88.30 42.85Q88.30 43.90 87.60 44.60Q86.90 45.30 85.85 45.30M88.30 29.25Q93.20 28.95 97.50 27.27Q101.80 25.60 101.80 21.90Q101.80 19.15 98.48 17.65Q95.15 16.15 89.00 16.15L88.30 16.15L88.30 29.25ZM113.20 45.30Q112.25 45.30 111.50 44.60Q110.75 43.90 110.75 43L110.75 22.75Q110.75 21.75 111.48 21.05Q112.20 20.35 113.20 20.35Q114.20 20.35 114.93 21.05Q115.65 21.75 115.65 22.75L115.65 24.25Q118.10 20.25 122.35 20.25Q124.90 20.25 126.03 21.65Q127.15 23.05 127.15 25L127.15 26.50Q127.15 27.50 126.48 28.18Q125.80 28.85 124.80 28.85Q123.60 28.85 123.03 28.15Q122.45 27.45 122.45 26.45L122.45 25.80Q122.45 25 121.35 25Q120.45 25 119.28 25.90Q118.10 26.80 117.35 27.80Q116.30 29.10 115.98 30.40Q115.65 31.70 115.65 33.50L115.60 43Q115.60 43.90 114.85 44.60Q114.10 45.30 113.20 45.30ZM139.60 45.30Q136.75 45.30 134.38 43.75Q132.00 42.20 130.65 39.52Q129.30 36.85 129.30 33.70Q129.30 30.15 130.90 27.07Q132.50 24 135.20 22.17Q137.90 20.35 141.00 20.35Q143.85 20.35 146.23 21.95Q148.60 23.55 149.98 26.20Q151.35 28.85 151.35 31.90Q151.35 35.50 149.75 38.58Q148.15 41.65 145.43 43.48Q142.70 45.30 139.60 45.30M139.60 40.80Q141.35 40.80 142.95 39.60Q144.55 38.40 145.50 36.40Q146.45 34.40 146.45 32.15Q146.45 30.25 145.70 28.57Q144.95 26.90 143.65 25.88Q142.35 24.85 140.80 24.85Q139.05 24.85 137.53 26.07Q136.00 27.30 135.10 29.32Q134.20 31.35 134.20 33.65Q134.20 35.90 134.98 37.50Q135.75 39.10 136.98 39.95Q138.20 40.80 139.60 40.80ZM160.15 17.85Q159.10 17.85 158.43 17.07Q157.75 16.30 157.85 15.35L158.05 13.20Q158.10 12.30 158.83 11.75Q159.55 11.20 160.45 11.20Q161.55 11.20 162.23 12Q162.90 12.80 162.80 13.75L162.60 15.90Q162.55 16.80 161.78 17.32Q161.00 17.85 160.15 17.85M156.20 53.50Q154.15 53.50 152.35 52.20Q150.55 50.90 149.60 49.20Q149.05 48.25 149.05 47.75Q149.05 46.80 149.75 46.10Q150.45 45.40 151.50 45.40Q153.10 45.40 153.80 47.10Q154.15 48 154.73 48.48Q155.30 48.95 156.00 48.95Q156.90 48.95 157.40 48.02Q157.90 47.10 157.90 45.30Q157.90 42.90 157.85 39.73Q157.80 36.55 157.75 33.40Q157.60 26.65 157.60 22.70Q157.60 21.65 158.28 20.95Q158.95 20.25 160.00 20.25Q160.95 20.25 161.68 20.97Q162.40 21.70 162.40 22.65L162.50 32.85Q162.65 39.80 162.65 44.25Q162.65 48.80 160.90 51.15Q159.15 53.50 156.20 53.50ZM180.60 45.30Q177.05 45.30 174.23 43.77Q171.40 42.25 169.80 39.42Q168.20 36.60 168.20 32.75Q168.20 29.60 169.63 26.72Q171.05 23.85 173.63 22.10Q176.20 20.35 179.50 20.35Q182.55 20.35 184.73 21.57Q186.90 22.80 188.00 24.50Q189.10 26.20 189.10 27.55Q189.10 28.20 188.70 28.80Q188.30 29.40 187.55 29.85L174.15 37.55Q174.85 39.10 176.63 39.95Q178.40 40.80 180.60 40.80Q183.50 40.80 185.55 38.65Q186.35 37.85 187.20 37.85Q188.20 37.85 188.88 38.50Q189.55 39.15 189.55 40.10Q189.55 40.90 188.95 41.60Q187.55 43.15 185.23 44.23Q182.90 45.30 180.60 45.30M184.15 26.95Q183.55 25.90 182.45 25.38Q181.35 24.85 179.85 24.85Q177.00 24.85 175.08 26.80Q173.15 28.75 172.85 31.60Q172.75 32.35 172.75 33.40L184.15 26.95ZM203.65 45.30Q200.65 45.30 198.15 43.85Q195.65 42.40 194.20 39.88Q192.75 37.35 192.75 34.35Q192.75 30.95 194.35 27.70Q195.95 24.45 198.55 22.40Q201.15 20.35 204.05 20.35Q206.70 20.35 208.33 21.17Q209.95 22 211.50 23.80Q212.25 24.60 212.25 25.55Q212.25 26.50 211.55 27.18Q210.85 27.85 209.85 27.85Q209.20 27.85 208.83 27.65Q208.45 27.45 207.95 26.85Q207.10 25.90 206.28 25.40Q205.45 24.90 204.10 24.90Q202.55 24.90 200.98 26.25Q199.40 27.60 198.43 29.77Q197.45 31.95 197.45 34.25Q197.45 36.25 198.33 37.73Q199.20 39.20 200.60 39.98Q202.00 40.75 203.55 40.75Q205.55 40.75 206.83 40Q208.10 39.25 209.10 37.95Q210.05 36.70 211.25 36.70Q212.20 36.70 212.90 37.38Q213.60 38.05 213.60 38.90Q213.60 39.90 213.05 40.60Q211.60 42.55 209.10 43.92Q206.60 45.30 203.65 45.30ZM222.20 45.35Q221.25 45.35 220.53 44.65Q219.80 43.95 219.80 43L219.80 25.15L215.85 25.15Q214.85 25.15 214.15 24.42Q213.45 23.70 213.45 22.75Q213.45 21.65 214.20 20.97Q214.95 20.30 215.95 20.30L219.80 20.30L219.80 14.95Q219.80 14 220.50 13.25Q221.20 12.50 222.20 12.50Q223.25 12.50 223.93 13.22Q224.60 13.95 224.60 14.95L224.60 20.30L228.85 20.30Q229.85 20.30 230.55 21Q231.25 21.70 231.25 22.75Q231.25 23.70 230.55 24.42Q229.85 25.15 228.85 25.15L224.60 25.15L224.60 43Q224.60 43.95 223.90 44.65Q223.20 45.35 222.20 45.35ZM241.45 45.30Q238.55 45.30 236.43 44.02Q234.30 42.75 233.18 41.08Q232.05 39.40 232.05 38.35Q232.05 37.35 232.75 36.67Q233.45 36 234.40 36Q235.25 36 235.83 36.45Q236.40 36.90 236.65 37.65Q237.20 39.20 238.45 40.10Q239.70 41 241.55 41Q243.50 41 244.60 40.05Q245.70 39.10 245.70 37.90Q245.70 36.75 244.78 36.08Q243.85 35.40 241.05 34.55Q236.95 33.30 235.15 31.57Q233.35 29.85 233.35 27.05Q233.35 24.10 235.70 22.22Q238.05 20.35 242.25 20.35Q246.15 20.35 248.33 22.05Q250.50 23.75 250.50 26.60Q250.50 28.15 249.85 28.97Q249.20 29.80 248.00 29.80Q246.95 29.80 246.30 29.15Q245.65 28.50 245.65 27.75Q245.65 27.50 245.78 27.13Q245.90 26.75 245.90 26.55Q245.90 25.65 245.03 25.10Q244.15 24.55 242.35 24.55Q240.10 24.55 239.03 25.20Q237.95 25.85 237.95 26.95Q237.95 28.10 239.05 28.82Q240.15 29.55 243.00 30.45Q247.15 31.75 248.78 33.30Q250.40 34.85 250.40 37.65Q250.40 39.55 249.28 41.33Q248.15 43.10 246.13 44.20Q244.10 45.30 241.45 45.30Z"
          width="21vw"
          viewBox="-1 10 252 45"
          titleAnimated={titleAnimated}
        />
      </div>
      <div className={classes.projects}>
        <VerticalTitles
          projectsAnimationRef={projectsAnimationRef}
          clickedBtnIndex={clickedBtnIndex}
          setClickedBtnIndex={setClickedBtnIndex}
          setPrimaryImage={setPrimaryImage}
          setSecondaryImage={setSecondaryImage}
          setWebsiteUrl={setWebsiteUrl}
          setGithubUrl={setGithubUrl}
          setIsDuringAnimation={setIsDuringAnimation}
          navigateToSection={navigateToSection}
        />
        <ProjectsImages
          projectsAnimationRef={projectsAnimationRef}
          clickedBtnIndex={clickedBtnIndex}
          primaryImage={primaryImage}
          secondaryImage={secondaryImage}
          websiteUrl={websiteUrl}
          githubUrl={githubUrl}
          isDuringAnimation={isDuringAnimation}
        />
      </div>
    </div>
  );
};

export default Projects;
